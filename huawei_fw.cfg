#主设备配置
install feature-software WEAKEA
mmi-mode enable
system-view
sysname JH.KD.INC.FW.M-X.251
#
undo ftp server source all-interface
undo ftp ipv6 server source all-interface
telnet server disable
telnet ipv6 server disable
undo telnet server-source all-interface
undo telnet ipv6 server-source all-interface
arp learning on-different-segment disable
lldp enable
 #undo firewall session link-state check
 #undo firewall ipv6 session link-state check
#
vsys enable
resource-class r0
#
dns resolve
dns server 10.193.133.2
dns server 10.1.12.80
#
firewall defend action discard
#
#
info-center loghost source GE0/0/0
info-center loghost 10.193.134.168 vpn-instance _management_vpn_ port 34514
#
log type policy enable
#
log type traffic enable
#
log type traffic-report enable
#
info-center loghost vsys-to-public enable
#
firewall log host 1 10.193.134.168 34514 vpn-instance _management_vpn_
firewall log session logging enable
firewall log session multi-host-mode concurrent
firewall log session log-type syslog
firewall log encrypt-algorithm aes256-gcm
#
aaa
 local-aaa-user password policy administrator
  password history record number 0
  undo password alert original
  password expire 0
  quit
 local-aaa-user user-name complexity-check disable

 local-user lpadmin password irreversible-cipher L!#switch@123
 local-user lpadmin privilege level 3
 local-user lpadmin service-type ssh http

 local-user show password irreversible-cipher Leap#show^3
 local-user show privilege level 1
 local-user show service-type ssh http
 local-user show user-group system-ug
#
user-interface con 0
 idle-timeout 15 0
 authentication-mode password
 set authentication password cipher LProuter@123
#
user-interface vty 0 14
 authentication-mode aaa
 user privilege level 1
 protocol inbound ssh
 idle-timeout 15 0
#
web-manager enable port 8443
web-manager timeout 15
web-manager max-user-number 10
web-manager http forward enable
web-manager server-source -i GE0/0/0
undo web-manager server-source all-interface
#
acl number 2098
 description "ssh acl"
 rule 0 permit source 10.X.Y.Z 0.0.0.255 vpn-instance _management_vpn_
 rule 10 permit source 10.192.0.22 0 vpn-instance _management_vpn_
 rule 15 permit source 10.192.1.74 0 vpn-instance _management_vpn_
 rule 20 permit source 10.192.1.200 0 vpn-instance _management_vpn_
 rule 25 permit source 10.192.1.218 0 vpn-instance _management_vpn_
 rule 30 permit source 10.192.7.137 0 vpn-instance _management_vpn_
#以上为固定地址，以下根据地区与现场环境自行更改添加，新增在序号中间新增即可
 rule 100 permit source 10.193.134.196 0 vpn-instance _management_vpn_
 rule 105 permit source 10.193.134.135 0 vpn-instance _management_vpn_
#以下为个人电脑
 rule 150 permit source 10.193.100.0 0.0.0.255 vpn-instance _management_vpn_
 rule 155 permit source 10.192.67.124 0 vpn-instance _management_vpn_
 rule 160 permit source 10.192.67.158 0 vpn-instance _management_vpn_
 rule 165 permit source 10.192.200.158 0 vpn-instance _management_vpn_
 rule 1000 deny vpn-instance _management_vpn_
#
#acl number 2099
 #description "snmp acl"
#
interface Eth-Trunk1
#
interface Eth-Trunk1.1
#
interface Eth-Trunk1.2
#
interface Eth-Trunk1.3
#
interface Eth-Trunk1.4
#
interface Eth-Trunk1.5
#
interface Eth-Trunk1.6
#
interface Eth-Trunk1.7
#
interface Eth-Trunk1.8
#
interface Eth-Trunk1.9
#
#interface Eth-Trunk1.10
#
interface Eth-Trunk1.21
#
interface Eth-Trunk1.22
#
interface Eth-Trunk1.23
#
interface Eth-Trunk1.24
#
interface Eth-Trunk1.25
#
interface Eth-Trunk1.26
#
interface Eth-Trunk1.27
#
interface Eth-Trunk1.28
#
interface Eth-Trunk1.29
#
#interface Eth-Trunk1.30
#
vsys name Management 1
 assign interface Eth-Trunk1.21
 assign interface Eth-Trunk1.1
 assign resource-class r0
#
vsys name Server 2
 assign interface Eth-Trunk1.22
 assign interface Eth-Trunk1.2
 assign resource-class r0
#
vsys name Test 3
 assign interface Eth-Trunk1.23
 assign interface Eth-Trunk1.3
 assign resource-class r0
#
vsys name Security 4
 assign interface Eth-Trunk1.24
 assign interface Eth-Trunk1.4
 assign resource-class r0
#
vsys name OA 5
 assign interface Eth-Trunk1.25
 assign interface Eth-Trunk1.5
 assign resource-class r0
#
vsys name PD 6
 assign interface Eth-Trunk1.26
 assign interface Eth-Trunk1.6
 assign resource-class r0
#
vsys name JK 7
 assign interface Eth-Trunk1.27
 assign interface Eth-Trunk1.7
 assign resource-class r0
#
vsys name Guest 8
 assign interface Eth-Trunk1.28
 assign interface Eth-Trunk1.8
 assign resource-class r0
#
vsys name OTA 9
 assign interface Eth-Trunk1.29
 assign interface Eth-Trunk1.9
 assign resource-class r0
#
#vsys name Other 10
 #assign interface Eth-Trunk1.30
 #assign interface Eth-Trunk1.10
 #assign resource-class r0
#
interface MEth0/0/0
 shutdown
 ip binding vpn-instance _management_vpn_
#
interface Eth-Trunk1
 mode lacp-static
#
#interface Eth-Trunk1.1
 ip binding vpn-instance Management
 ip address 172.30.X.5 255.255.255.248
 dot1q termination vid 4001
 vrrp vrid 1 virtual-ip 172.30.X.4 active
 service-manage ping permit
#
interface Eth-Trunk1.2
 ip binding vpn-instance Server
 ip address 172.30.X.13 255.255.255.248
 dot1q termination vid 4002
 vrrp vrid 8 virtual-ip 172.30.X.12 active
 service-manage ping permit
#
interface Eth-Trunk1.3
 ip binding vpn-instance Test
 ip address 172.30.X.21 255.255.255.248
 dot1q termination vid 4003
 vrrp vrid 16 virtual-ip 172.30.X.20 active
 service-manage ping permit
#
interface Eth-Trunk1.4
 ip binding vpn-instance Security
 ip address 172.30.X.29 255.255.255.248
 dot1q termination vid 4004
 vrrp vrid 24 virtual-ip 172.30.X.28 active
 service-manage ping permit
#
interface Eth-Trunk1.5
 ip binding vpn-instance OA
 ip address 172.30.X.37 255.255.255.248
 dot1q termination vid 4005
 vrrp vrid 32 virtual-ip 172.30.X.36 active
 service-manage ping permit
#
interface Eth-Trunk1.6
 ip binding vpn-instance PD
 ip address 172.30.X.45 255.255.255.248
 dot1q termination vid 4006
 vrrp vrid 40 virtual-ip 172.30.X.44 active
 service-manage ping permit
#
interface Eth-Trunk1.7
 ip binding vpn-instance JK
 ip address 172.30.X.53 255.255.255.248
 dot1q termination vid 4007
 vrrp vrid 48 virtual-ip 172.30.X.52 active
 service-manage ping permit
#
interface Eth-Trunk1.8
 ip binding vpn-instance Guest
 ip address 172.30.X.61 255.255.255.248
 dot1q termination vid 4008
 vrrp vrid 56 virtual-ip 172.30.X.60 active
 service-manage ping permit
#
interface Eth-Trunk1.9
 ip binding vpn-instance OTA
 ip address 172.30.X.69 255.255.255.248
 dot1q termination vid 4008
 vrrp vrid 64 virtual-ip 172.30.X.68 active
 service-manage ping permit
#
#interface Eth-Trunk1.10
 #ip binding vpn-instance Other
 #ip address 172.30.X.77 255.255.255.248
 #dot1q termination vid 4008
 #vrrp vrid 72 virtual-ip 172.30.X.76 active
 #service-manage ping permit
#
interface Eth-Trunk1.21
 ip binding vpn-instance Management
 ip address 172.30.X.85 255.255.255.248
 dot1q termination vid 4021
 vrrp vrid 80 virtual-ip 172.30.X.84 active
 service-manage ping permit
#
interface Eth-Trunk1.22
 ip binding vpn-instance Server
 ip address 172.30.X.93 255.255.255.248
 dot1q termination vid 4022
 vrrp vrid 88 virtual-ip 172.30.X.92 active
 service-manage ping permit
#
interface Eth-Trunk1.23
 ip binding vpn-instance Test
 ip address 172.30.X.101 255.255.255.248
 dot1q termination vid 4023
 vrrp vrid 96 virtual-ip 172.30.X.100 active
 service-manage ping permit
#
interface Eth-Trunk1.24
 ip binding vpn-instance Security
 ip address 172.30.X.109 255.255.255.248
 dot1q termination vid 4024
 vrrp vrid 104 virtual-ip 172.30.X.108 active
 service-manage ping permit
#
interface Eth-Trunk1.25
 ip binding vpn-instance OA
 ip address 172.30.X.117 255.255.255.248
 dot1q termination vid 4025
 vrrp vrid 112 virtual-ip 172.30.X.116 active
 service-manage ping permit
#
interface Eth-Trunk1.26
 ip binding vpn-instance PD
 ip address 172.30.X.125 255.255.255.248
 dot1q termination vid 4026
 vrrp vrid 120 virtual-ip 172.30.X.124 active
 service-manage ping permit
#
interface Eth-Trunk1.27
 ip binding vpn-instance JK
 ip address 172.30.X.133 255.255.255.248
 dot1q termination vid 4027
 vrrp vrid 128 virtual-ip 172.30.X.132 active
 service-manage ping permit
#
interface Eth-Trunk1.28
 ip binding vpn-instance Guest
 ip address 172.30.X.141 255.255.255.248
 dot1q termination vid 4028
 vrrp vrid 136 virtual-ip 172.30.X.140 active
 service-manage ping permit
#
interface Eth-Trunk1.29
 ip binding vpn-instance OTA
 ip address 172.30.X.149 255.255.255.248
 dot1q termination vid 4028
 vrrp vrid 144 virtual-ip 172.30.X.148 active
 service-manage ping permit
#
#interface Eth-Trunk1.30
 #ip binding vpn-instance Other
 #ip address 172.30.X.157 255.255.255.248
 #dot1q termination vid 4029
 #vrrp vrid 152 virtual-ip 172.30.X.156 active
 #service-manage ping permit
#
interface Eth-Trunk63
 description HRP-To-JH.KD.INC.FW.S-128.252
 ip address 1.1.1.1 255.255.255.252
 mode lacp-static
 service-manage ping permit
#
interface GE0/0/0
 ip binding vpn-instance _management_vpn_
 ip address 10.X.X.251 255.255.255.0
 service-manage https permit
 service-manage ping permit
 service-manage snmp permit
 service-manage ssh permit
#
interface 10GE0/0/0
 eth-trunk 1
#
interface 10GE0/0/1
 eth-trunk 1
#
interface 10GE0/0/2
#
interface 10GE0/0/3
#
interface 10GE0/0/4
 eth-trunk 63
#
interface 10GE0/0/5
 eth-trunk 63
#
hrp standby config enable
hrp auto-sync config static-route
hrp auto-sync config policy-based-route
hrp mirror session enable
hrp interface Eth-Trunk63 remote 1.1.1.2
hrp track interface Eth-Trunk1
hrp authentication-key L!#2019-leap
hrp enable
undo hrp track trunk-member enable
#
stelnet server enable
#ssh server acl 2098
ssh server-source -i GE0/0/0
undo ssh server-source all-interface
undo ssh ipv6 server-source all-interface
ssh authorization-type default aaa
ssh client first-time enable
ssh server key-exchange dh_group_exchange_sha256
ssh server publickey ecc
#
clock timezone BJ add 08:00:00
ntp ipv6 server disable
ntp server source-interface all disable
ntp ipv6 server source-interface all disable
ntp unicast-server 10.1.12.80 vpn-instance _management_vpn_ source-interface GE0/0/0
ntp unicast-server 10.1.12.81 vpn-instance _management_vpn_ source-interface GE0/0/0
ntp source-interface GE0/0/0 vpn-instance _management_vpn_
#
snmp-agent
snmp-agent community complexity-check disable
snmp-agent community read cipher leapmotor
snmp-agent sys-info version v2c v3
snmp-agent trap source GE0/0/0
snmp-agent protocol source-interface GE0/0/0
undo snmp-agent protocol source-status all-interface
undo snmp-agent protocol source-status ipv6 all-interface
undo snmp-agent proxy protocol source-status all-interface
undo snmp-agent proxy protocol source-status ipv6 all-interface
snmp-agent trap enable
#
firewall zone trust
 add interface GE0/0/0
#
firewall zone dmz
 add interface Eth-Trunk63
#
firewall detect ftp
#
security-policy
 rule name hrp
  source-zone dmz
  source-zone local
  destination-zone dmz
  destination-zone local
  service protocol udp source-port 0 to 65535 destination-port 18514
  action permit
 rule name local_to_any
  source-zone local
  source-zone trust
  policy logging
  session logging
  traffic logging enable
  action permit
#
rule move hrp top
rule move local_to_any after hrp
#
ip route-static vpn-instance _management_vpn_ 0.0.0.0 0.0.0.0 10.X.X.254
#
switch vsys Management
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.81
ip route-static 10.X.X.0 255.255.X.0 172.30.X.1
#
firewall zone trust
 add interface Eth-Trunk1.1
#
firewall zone untrust
 add interface Eth-Trunk1.21
#
ip address-set JumpServer type object
 undo address all
 address 0 10.192.0.22 mask 32
 address 1 10.192.1.74 mask 32
 address 2 10.192.1.200 mask 32
 address 3 10.192.1.218 mask 32
 address 4 10.193.134.196 mask 32
 address 5 10.193.134.135 mask 32
#
ip address-set IT type object
 undo address all
 address 0 10.192.7.137 mask 32
 address 1 10.193.100.0 mask 24
 address 2 10.192.67.124 mask 32
 address 3 10.192.67.158 mask 32
 address 4 10.192.200.158 mask 32
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name jumpserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set JumpServer
  service telnet ssh rdp-tcp rdp-udp
  policy logging
  session logging
  action permit
  quit
 rule name it_permit
  source-zone untrust
  destination-zone trust
  source-address address-set IT
  policy logging
  session logging
  action permit
  quit
 rule name trust_to_any
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move it_permit after icmp
#
quit
quit
switch vsys Server
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.89
ip route-static 10.X.X.0 255.255.X.0 172.30.X.9
#
firewall zone trust
 add interface Eth-Trunk1.2
#
firewall zone untrust
 add interface Eth-Trunk1.22
#
ip address-set LingJie_Connect type object
 undo address all
 address 0 10.192.6.59 mask 32
 address 1 10.192.6.62 mask 32
 address 2 10.192.6.67 mask 32
 address 3 10.192.6.81 mask 32
 address 4 10.192.6.115 mask 32
 address 5 10.192.123.8 mask 32
#
ip address-set Nginx type object
 undo address all
 #address 0 10.x.x.x mask 32
 #address 1 10.x.x.x mask 32
 #address 2 10.x.x.x mask 32
#
ip address-set JumpServer type object
 undo address all
 address 0 10.192.0.22 mask 32
 address 1 10.192.1.74 mask 32
 address 2 10.192.1.200 mask 32
 address 3 10.192.1.218 mask 32
 address 4 10.193.134.196 mask 32
 address 5 10.193.134.135 mask 32
#
ip address-set BasicServer type group
 address 0 address-set LingJie_Connect
 address 1 address-set Nginx
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name jumpserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set JumpServer
  service telnet ssh rdp-tcp rdp-udp
  policy logging
  session logging
  action permit
  quit
 rule name basicserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set BasicServer
  policy logging
  session logging
  action permit
  quit
 rule name trust_to_any
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move jumpserver_permit after icmp
rule move basicserver_permit after jumpserver_permit
rule move trust_to_any after basicserver_permit
#
quit
quit
switch vsys Test
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.96
ip route-static 10.X.X.0 255.255.X.0 172.30.X.16
#
firewall zone trust
 add interface Eth-Trunk1.3
#
firewall zone untrust
 add interface Eth-Trunk1.23
#
ip address-set LingJie_Connect type object
 undo address all
 address 0 10.192.6.59 mask 32
 address 1 10.192.6.62 mask 32
 address 2 10.192.6.67 mask 32
 address 3 10.192.6.81 mask 32
 address 4 10.192.6.115 mask 32
 address 5 10.192.123.8 mask 32
#
ip address-set Nginx type object
 undo address all
 #address 0 10.x.x.x mask 32
 #address 1 10.x.x.x mask 32
 #address 2 10.x.x.x mask 32
#
ip address-set JumpServer type object
 undo address all
 address 0 10.192.0.22 mask 32
 address 1 10.192.1.74 mask 32
 address 2 10.192.1.200 mask 32
 address 3 10.192.1.218 mask 32
 address 4 10.193.134.196 mask 32
 address 5 10.193.134.135 mask 32
#
ip address-set BasicServer type group
 address 0 address-set LingJie_Connect
 address 1 address-set Nginx
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name jumpserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set JumpServer
  service telnet ssh rdp-tcp rdp-udp
  policy logging
  session logging
  action permit
  quit
 rule name basicserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set BasicServer
  policy logging
  session logging
  action permit
  quit
 rule name trust_to_any
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move jumpserver_permit after icmp
rule move basicserver_permit after jumpserver_permit
rule move trust_to_any after basicserver_permit
#
quit
quit
switch vsys Security
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.104
ip route-static 10.X.X.0 255.255.X.0 172.30.X.24
#
firewall zone trust
 add interface Eth-Trunk1.4
#
firewall zone untrust
 add interface Eth-Trunk1.24
#
ip address-set LingJie_Connect type object
 undo address all
 address 0 10.192.6.59 mask 32
 address 1 10.192.6.62 mask 32
 address 2 10.192.6.67 mask 32
 address 3 10.192.6.81 mask 32
 address 4 10.192.6.115 mask 32
 address 5 10.192.123.8 mask 32
#
ip address-set Nginx type object
 undo address all
 #address 0 10.x.x.x mask 32
 #address 1 10.x.x.x mask 32
 #address 2 10.x.x.x mask 32
#
ip address-set JumpServer type object
 undo address all
 address 0 10.192.0.22 mask 32
 address 1 10.192.1.74 mask 32
 address 2 10.192.1.200 mask 32
 address 3 10.192.1.218 mask 32
 address 4 10.193.134.196 mask 32
 address 5 10.193.134.135 mask 32
#
ip address-set BasicServer type group
 address 0 address-set LingJie_Connect
 address 1 address-set Nginx
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name jumpserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set JumpServer
  service telnet ssh rdp-tcp rdp-udp
  policy logging
  session logging
  action permit
  quit
 rule name basicserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set BasicServer
  policy logging
  session logging
  action permit
  quit
 rule name trust_to_any
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move jumpserver_permit after icmp
rule move basicserver_permit after jumpserver_permit
rule move trust_to_any after basicserver_permit
#
quit
quit
switch vsys OA
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.113
ip route-static 10.X.X.0 255.255.X.0 172.30.X.33
#
firewall zone trust
 add interface Eth-Trunk1.5
#
firewall zone untrust
 add interface Eth-Trunk1.25
#
ip address-set LingJie_Connect type object
 undo address all
 address 0 10.192.6.59 mask 32
 address 1 10.192.6.62 mask 32
 address 2 10.192.6.67 mask 32
 address 3 10.192.6.81 mask 32
 address 4 10.192.6.115 mask 32
 address 5 10.192.123.8 mask 32
#
ip address-set BasicServer type group
 address 0 address-set LingJie_Connect
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name basicserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set BasicServer
  policy logging
  session logging
  action permit
  quit
 rule name trust_to_any
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move basicserver_permit after icmp
rule move trust_to_any after basicserver_permit
#
quit
quit
switch vsys PD
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.121
ip route-static 10.X.X.0 255.255.X.0 172.30.X.41
#
firewall zone trust
 add interface Eth-Trunk1.6
#
firewall zone untrust
 add interface Eth-Trunk1.26
#
ip address-set LingJie_Connect type object
 undo address all
 address 0 10.192.6.59 mask 32
 address 1 10.192.6.62 mask 32
 address 2 10.192.6.67 mask 32
 address 3 10.192.6.81 mask 32
 address 4 10.192.6.115 mask 32
 address 5 10.192.123.8 mask 32
#
ip address-set Nginx type object
 undo address all
 #address 0 10.x.x.x mask 32
 #address 1 10.x.x.x mask 32
 #address 2 10.x.x.x mask 32
#
ip address-set Zhunru_Server type object
 undo address all
 #address 0 10.x.x.x mask 32
#
ip address-set JumpServer type object
 undo address all
 address 0 10.192.0.22 mask 32
 address 1 10.192.1.74 mask 32
 address 2 10.192.1.200 mask 32
 address 3 10.192.1.218 mask 32
 address 4 10.193.134.196 mask 32
 address 5 10.193.134.135 mask 32
#
ip address-set BasicServer type group
 address 0 address-set LingJie_Connect
 address 1 address-set Nginx
 address 2 address-set Zhunru_Server
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name jumpserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set JumpServer
  service telnet ssh rdp-tcp rdp-udp
  policy logging
  session logging
  action permit
  quit
 rule name basicserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set BasicServer
  policy logging
  session logging
  action permit
  quit
 rule name trust_to_any
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move jumpserver_permit after icmp
rule move basicserver_permit after jumpserver_permit
rule move trust_to_any after basicserver_permit
#
quit
quit
switch vsys JK
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.129
ip route-static 10.X.X.0 255.255.X.0 172.30.X.49
firewall zone trust
 add interface Eth-Trunk1.7
#
firewall zone untrust
 add interface Eth-Trunk1.27
#
ip address-set kqj_server type object
 address 0 10.192.7.73 mask 32
#
ip address-set visitor_device type object
 #address 0 10.X.X.X mask 32
 #address 1 10.X.X.X mask 32
#
ip address-set visitor_server type object
 address 0 10.195.147.156 mask 32
#
ip address-set kqj&visitor_server type group
 address 0 address-set kqj_server
 address 1 address-set visitor_server
#
domain-set name visitor_plat
 add domain entranceguard.leapmotor.com
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
rule name server_to_jk
  source-zone untrust
  destination-zone trust
  source-address address-set kqj_server
  source-address address-set visitor_server
  service http
  service https
  service protocol tcp source-port 0 to 65535 destination-port 37777
  policy logging
  session logging
  traffic logging enable
  action permit
  quit
rule name fkdevice_to_fkplat
  source-zone trust
  destination-zone untrust
  source-address address-set visitor_device
  destination-address domain-set visitor_plat
  service https
  policy logging
  session logging
  traffic logging enable
  action permit
  quit
rule move icmp top
rule move server_to_jk after icmp
rule move fkdevice_to_fkplat after server_to_jk
#
quit
quit
switch vsys Guest
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.137
ip route-static 10.X.X.0 255.255.X.0 172.30.X.57
#
firewall zone trust
 add interface Eth-Trunk1.8
#
firewall zone untrust
 add interface Eth-Trunk1.28
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name deny_internal
  source-zone trust
  destination-zone untrust
  destination-address 10.0.0.0 mask 255.0.0.0
  policy logging
  session logging
  action deny
  quit
 rule name trust_to_internet
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move deny_internal after icmp
rule move trust_to_internet after deny_internal
#
quit
quit
switch vsys OTA
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.145
ip route-static 10.X.X.0 255.255.X.0 172.30.X.65
#
firewall zone trust
 add interface Eth-Trunk1.9
#
firewall zone untrust
 add interface Eth-Trunk1.29
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
quit
rule move icmp top
#
quit
quit
undo mmi-mode enable


#备设备配置
install feature-software WEAKEA
mmi-mode enable
system-view
sysname JH.KD.INC.FW.S-X.252
#
undo ftp server source all-interface
undo ftp ipv6 server source all-interface
telnet server disable
telnet ipv6 server disable
undo telnet server-source all-interface
undo telnet ipv6 server-source all-interface
arp learning on-different-segment disable
lldp enable
 #undo firewall session link-state check
 #undo firewall ipv6 session link-state check
#
vsys enable
resource-class r0
#
dns resolve
dns server 10.193.133.2
dns server 10.1.12.80
#
firewall defend action discard
#
#
info-center loghost source GE0/0/0
info-center loghost 10.193.134.168 vpn-instance _management_vpn_ port 34514
#
log type policy enable
#
log type traffic enable
#
log type traffic-report enable
#
info-center loghost vsys-to-public enable
#
firewall log host 1 10.193.134.168 34514 vpn-instance _management_vpn_
firewall log session logging enable
firewall log session multi-host-mode concurrent
firewall log session log-type syslog
firewall log encrypt-algorithm aes256-gcm
#
aaa
 local-aaa-user password policy administrator
  password history record number 0
  undo password alert original
  password expire 0
  quit
 local-aaa-user user-name complexity-check disable

 local-user lpadmin password irreversible-cipher L!#switch@123
 local-user lpadmin privilege level 3
 local-user lpadmin service-type ssh http

 local-user show password irreversible-cipher Leap#show^3
 local-user show privilege level 1
 local-user show service-type ssh http
 local-user show user-group system-ug
#
user-interface con 0
 idle-timeout 15 0
 authentication-mode password
 set authentication password cipher LProuter@123
#
user-interface vty 0 14
 authentication-mode aaa
 user privilege level 1
 protocol inbound ssh
 idle-timeout 15 0
#
web-manager enable port 8443
web-manager timeout 15
web-manager max-user-number 10
web-manager http forward enable
web-manager server-source -i GE0/0/0
undo web-manager server-source all-interface
#
acl number 2098
 description "ssh acl"
 rule 0 permit source 10.X.Y.Z 0.0.0.255 vpn-instance _management_vpn_
 rule 10 permit source 10.192.0.22 0 vpn-instance _management_vpn_
 rule 15 permit source 10.192.1.74 0 vpn-instance _management_vpn_
 rule 20 permit source 10.192.1.200 0 vpn-instance _management_vpn_
 rule 25 permit source 10.192.1.218 0 vpn-instance _management_vpn_
 rule 30 permit source 10.192.7.137 0 vpn-instance _management_vpn_
#以上为固定地址，以下根据地区与现场环境自行更改添加，新增在序号中间新增即可
 rule 100 permit source 10.193.134.196 0 vpn-instance _management_vpn_
 rule 105 permit source 10.193.134.135 0 vpn-instance _management_vpn_
#以下为个人电脑
 rule 150 permit source 10.193.100.0 0.0.0.255 vpn-instance _management_vpn_
 rule 155 permit source 10.192.67.124 0 vpn-instance _management_vpn_
 rule 160 permit source 10.192.67.158 0 vpn-instance _management_vpn_
 rule 165 permit source 10.192.200.158 0 vpn-instance _management_vpn_
 rule 1000 deny vpn-instance _management_vpn_
#
#acl number 2099
 #description "snmp acl"
#
interface Eth-Trunk1
#
interface Eth-Trunk1.1
#
interface Eth-Trunk1.2
#
interface Eth-Trunk1.3
#
interface Eth-Trunk1.4
#
interface Eth-Trunk1.5
#
interface Eth-Trunk1.6
#
interface Eth-Trunk1.7
#
interface Eth-Trunk1.8
#
interface Eth-Trunk1.9
#
#interface Eth-Trunk1.10
#
interface Eth-Trunk1.21
#
interface Eth-Trunk1.22
#
interface Eth-Trunk1.23
#
interface Eth-Trunk1.24
#
interface Eth-Trunk1.25
#
interface Eth-Trunk1.26
#
interface Eth-Trunk1.27
#
interface Eth-Trunk1.28
#
interface Eth-Trunk1.29
#
#interface Eth-Trunk1.30
#
vsys name Management 1
 assign interface Eth-Trunk1.21
 assign interface Eth-Trunk1.1
 assign resource-class r0
#
vsys name Server 2
 assign interface Eth-Trunk1.22
 assign interface Eth-Trunk1.2
 assign resource-class r0
#
vsys name Test 3
 assign interface Eth-Trunk1.23
 assign interface Eth-Trunk1.3
 assign resource-class r0
#
vsys name Security 4
 assign interface Eth-Trunk1.24
 assign interface Eth-Trunk1.4
 assign resource-class r0
#
vsys name OA 5
 assign interface Eth-Trunk1.25
 assign interface Eth-Trunk1.5
 assign resource-class r0
#
vsys name PD 6
 assign interface Eth-Trunk1.26
 assign interface Eth-Trunk1.6
 assign resource-class r0
#
vsys name JK 7
 assign interface Eth-Trunk1.27
 assign interface Eth-Trunk1.7
 assign resource-class r0
#
vsys name Guest 8
 assign interface Eth-Trunk1.28
 assign interface Eth-Trunk1.8
 assign resource-class r0
#
vsys name OTA 9
 assign interface Eth-Trunk1.29
 assign interface Eth-Trunk1.9
 assign resource-class r0
#
#vsys name Other 10
 #assign interface Eth-Trunk1.30
 #assign interface Eth-Trunk1.10
 #assign resource-class r0
#
interface MEth0/0/0
 shutdown
 ip binding vpn-instance _management_vpn_
#
interface Eth-Trunk1
 mode lacp-static
#
#interface Eth-Trunk1.1
 ip binding vpn-instance Management
 ip address 172.30.X.6 255.255.255.248
 dot1q termination vid 4001
 vrrp vrid 1 virtual-ip 172.30.X.4 standby
 service-manage ping permit
#
interface Eth-Trunk1.2
 ip binding vpn-instance Server
 ip address 172.30.X.14 255.255.255.248
 dot1q termination vid 4002
 vrrp vrid 8 virtual-ip 172.30.X.12 standby
 service-manage ping permit
#
interface Eth-Trunk1.3
 ip binding vpn-instance Test
 ip address 172.30.X.22 255.255.255.248
 dot1q termination vid 4003
 vrrp vrid 16 virtual-ip 172.30.X.20 standby
 service-manage ping permit
#
interface Eth-Trunk1.4
 ip binding vpn-instance Security
 ip address 172.30.X.30 255.255.255.248
 dot1q termination vid 4004
 vrrp vrid 24 virtual-ip 172.30.X.28 standby
 service-manage ping permit
#
interface Eth-Trunk1.5
 ip binding vpn-instance OA
 ip address 172.30.X.38 255.255.255.248
 dot1q termination vid 4005
 vrrp vrid 32 virtual-ip 172.30.X.36 standby
 service-manage ping permit
#
interface Eth-Trunk1.6
 ip binding vpn-instance PD
 ip address 172.30.X.46 255.255.255.248
 dot1q termination vid 4006
 vrrp vrid 40 virtual-ip 172.30.X.44 standby
 service-manage ping permit
#
interface Eth-Trunk1.7
 ip binding vpn-instance JK
 ip address 172.30.X.54 255.255.255.248
 dot1q termination vid 4007
 vrrp vrid 48 virtual-ip 172.30.X.52 standby
 service-manage ping permit
#
interface Eth-Trunk1.8
 ip binding vpn-instance Guest
 ip address 172.30.X.62 255.255.255.248
 dot1q termination vid 4008
 vrrp vrid 56 virtual-ip 172.30.X.60 standby
 service-manage ping permit
#
interface Eth-Trunk1.9
 ip binding vpn-instance OTA
 ip address 172.30.X.70 255.255.255.248
 dot1q termination vid 4008
 vrrp vrid 64 virtual-ip 172.30.X.68 standby
 service-manage ping permit
#
#interface Eth-Trunk1.10
 #ip binding vpn-instance Other
 #ip address 172.30.X.78 255.255.255.248
 #dot1q termination vid 4008
 #vrrp vrid 72 virtual-ip 172.30.X.76 standby
 #service-manage ping permit
#
interface Eth-Trunk1.21
 ip binding vpn-instance Management
 ip address 172.30.X.86 255.255.255.248
 dot1q termination vid 4021
 vrrp vrid 80 virtual-ip 172.30.X.84 standby
 service-manage ping permit
#
interface Eth-Trunk1.22
 ip binding vpn-instance Server
 ip address 172.30.X.94 255.255.255.248
 dot1q termination vid 4022
 vrrp vrid 88 virtual-ip 172.30.X.92 standby
 service-manage ping permit
#
interface Eth-Trunk1.23
 ip binding vpn-instance Test
 ip address 172.30.X.102 255.255.255.248
 dot1q termination vid 4023
 vrrp vrid 96 virtual-ip 172.30.X.100 standby
 service-manage ping permit
#
interface Eth-Trunk1.24
 ip binding vpn-instance Security
 ip address 172.30.X.110 255.255.255.248
 dot1q termination vid 4024
 vrrp vrid 104 virtual-ip 172.30.X.108 standby
 service-manage ping permit
#
interface Eth-Trunk1.25
 ip binding vpn-instance OA
 ip address 172.30.X.118 255.255.255.248
 dot1q termination vid 4025
 vrrp vrid 112 virtual-ip 172.30.X.116 standby
 service-manage ping permit
#
interface Eth-Trunk1.26
 ip binding vpn-instance PD
 ip address 172.30.X.126 255.255.255.248
 dot1q termination vid 4026
 vrrp vrid 120 virtual-ip 172.30.X.124 standby
 service-manage ping permit
#
interface Eth-Trunk1.27
 ip binding vpn-instance JK
 ip address 172.30.X.134 255.255.255.248
 dot1q termination vid 4027
 vrrp vrid 128 virtual-ip 172.30.X.132 standby
 service-manage ping permit
#
interface Eth-Trunk1.28
 ip binding vpn-instance Guest
 ip address 172.30.X.142 255.255.255.248
 dot1q termination vid 4028
 vrrp vrid 136 virtual-ip 172.30.X.140 standby
 service-manage ping permit
#
interface Eth-Trunk1.29
 ip binding vpn-instance OTA
 ip address 172.30.X.150 255.255.255.248
 dot1q termination vid 4028
 vrrp vrid 144 virtual-ip 172.30.X.148 standby
 service-manage ping permit
#
#interface Eth-Trunk1.30
 #ip binding vpn-instance Other
 #ip address 172.30.X.158 255.255.255.248
 #dot1q termination vid 4029
 #vrrp vrid 152 virtual-ip 172.30.X.156 standby
 #service-manage ping permit
#
interface Eth-Trunk63
 description HRP-To-JH.KD.INC.FW.M-128.251
 ip address 1.1.1.2 255.255.255.252
 mode lacp-static
 service-manage ping permit
#
interface GE0/0/0
 ip binding vpn-instance _management_vpn_
 ip address 10.X.X.252 255.255.255.0
 service-manage https permit
 service-manage ping permit
 service-manage snmp permit
 service-manage ssh permit
#
interface 10GE0/0/0
 eth-trunk 1
#
interface 10GE0/0/1
 eth-trunk 1
#
interface 10GE0/0/2
#
interface 10GE0/0/3
#
interface 10GE0/0/4
 eth-trunk 63
#
interface 10GE0/0/5
 eth-trunk 63
#
hrp standby config enable
hrp auto-sync config static-route
hrp auto-sync config policy-based-route
hrp mirror session enable
hrp interface Eth-Trunk63 remote 1.1.1.1
hrp track interface Eth-Trunk1
hrp authentication-key L!#2019-leap
hrp enable
undo hrp track trunk-member enable
#
stelnet server enable
#ssh server acl 2098
ssh server-source -i GE0/0/0
undo ssh server-source all-interface
undo ssh ipv6 server-source all-interface
ssh authorization-type default aaa
ssh client first-time enable
ssh server key-exchange dh_group_exchange_sha256
ssh server publickey ecc
#
clock timezone BJ add 08:00:00
ntp ipv6 server disable
ntp server source-interface all disable
ntp ipv6 server source-interface all disable
ntp unicast-server 10.1.12.80 vpn-instance _management_vpn_ source-interface GE0/0/0
ntp unicast-server 10.1.12.81 vpn-instance _management_vpn_ source-interface GE0/0/0
ntp source-interface GE0/0/0 vpn-instance _management_vpn_
#
snmp-agent
snmp-agent community complexity-check disable
snmp-agent community read cipher leapmotor
snmp-agent sys-info version v2c v3
snmp-agent trap source GE0/0/0
snmp-agent protocol source-interface GE0/0/0
undo snmp-agent protocol source-status all-interface
undo snmp-agent protocol source-status ipv6 all-interface
undo snmp-agent proxy protocol source-status all-interface
undo snmp-agent proxy protocol source-status ipv6 all-interface
snmp-agent trap enable
#
firewall zone trust
 add interface GE0/0/0
#
firewall zone dmz
 add interface Eth-Trunk63
#
firewall detect ftp
#
security-policy
 rule name hrp
  source-zone dmz
  source-zone local
  destination-zone dmz
  destination-zone local
  service protocol udp source-port 0 to 65535 destination-port 18514
  action permit
 rule name local_to_any
  source-zone local
  source-zone trust
  policy logging
  session logging
  traffic logging enable
  action permit
#
rule move hrp top
rule move local_to_any after hrp
#
ip route-static vpn-instance _management_vpn_ 0.0.0.0 0.0.0.0 10.X.X.254
#
switch vsys Management
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.81
ip route-static 10.X.X.0 255.255.X.0 172.30.X.1
#
firewall zone trust
 add interface Eth-Trunk1.1
#
firewall zone untrust
 add interface Eth-Trunk1.21
#
ip address-set JumpServer type object
 undo address all
 address 0 10.192.0.22 mask 32
 address 1 10.192.1.74 mask 32
 address 2 10.192.1.200 mask 32
 address 3 10.192.1.218 mask 32
 address 4 10.193.134.196 mask 32
 address 5 10.193.134.135 mask 32
#
ip address-set IT type object
 undo address all
 address 0 10.192.7.137 mask 32
 address 1 10.193.100.0 mask 24
 address 2 10.192.67.124 mask 32
 address 3 10.192.67.158 mask 32
 address 4 10.192.200.158 mask 32
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name jumpserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set JumpServer
  service telnet ssh rdp-tcp rdp-udp
  policy logging
  session logging
  action permit
  quit
 rule name it_permit
  source-zone untrust
  destination-zone trust
  source-address address-set IT
  policy logging
  session logging
  action permit
  quit
 rule name trust_to_any
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move it_permit after icmp
#
quit
quit
switch vsys Server
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.89
ip route-static 10.X.X.0 255.255.X.0 172.30.X.9
#
firewall zone trust
 add interface Eth-Trunk1.2
#
firewall zone untrust
 add interface Eth-Trunk1.22
#
ip address-set LingJie_Connect type object
 undo address all
 address 0 10.192.6.59 mask 32
 address 1 10.192.6.62 mask 32
 address 2 10.192.6.67 mask 32
 address 3 10.192.6.81 mask 32
 address 4 10.192.6.115 mask 32
 address 5 10.192.123.8 mask 32
#
ip address-set Nginx type object
 undo address all
 #address 0 10.x.x.x mask 32
 #address 1 10.x.x.x mask 32
 #address 2 10.x.x.x mask 32
#
ip address-set JumpServer type object
 undo address all
 address 0 10.192.0.22 mask 32
 address 1 10.192.1.74 mask 32
 address 2 10.192.1.200 mask 32
 address 3 10.192.1.218 mask 32
 address 4 10.193.134.196 mask 32
 address 5 10.193.134.135 mask 32
#
ip address-set BasicServer type group
 address 0 address-set LingJie_Connect
 address 1 address-set Nginx
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name jumpserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set JumpServer
  service telnet ssh rdp-tcp rdp-udp
  policy logging
  session logging
  action permit
  quit
 rule name basicserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set BasicServer
  policy logging
  session logging
  action permit
  quit
 rule name trust_to_any
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move jumpserver_permit after icmp
rule move basicserver_permit after jumpserver_permit
rule move trust_to_any after basicserver_permit
#
quit
quit
switch vsys Test
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.96
ip route-static 10.X.X.0 255.255.X.0 172.30.X.16
#
firewall zone trust
 add interface Eth-Trunk1.3
#
firewall zone untrust
 add interface Eth-Trunk1.23
#
ip address-set LingJie_Connect type object
 undo address all
 address 0 10.192.6.59 mask 32
 address 1 10.192.6.62 mask 32
 address 2 10.192.6.67 mask 32
 address 3 10.192.6.81 mask 32
 address 4 10.192.6.115 mask 32
 address 5 10.192.123.8 mask 32
#
ip address-set Nginx type object
 undo address all
 #address 0 10.x.x.x mask 32
 #address 1 10.x.x.x mask 32
 #address 2 10.x.x.x mask 32
#
ip address-set JumpServer type object
 undo address all
 address 0 10.192.0.22 mask 32
 address 1 10.192.1.74 mask 32
 address 2 10.192.1.200 mask 32
 address 3 10.192.1.218 mask 32
 address 4 10.193.134.196 mask 32
 address 5 10.193.134.135 mask 32
#
ip address-set BasicServer type group
 address 0 address-set LingJie_Connect
 address 1 address-set Nginx
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name jumpserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set JumpServer
  service telnet ssh rdp-tcp rdp-udp
  policy logging
  session logging
  action permit
  quit
 rule name basicserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set BasicServer
  policy logging
  session logging
  action permit
  quit
 rule name trust_to_any
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move jumpserver_permit after icmp
rule move basicserver_permit after jumpserver_permit
rule move trust_to_any after basicserver_permit
#
quit
quit
switch vsys Security
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.104
ip route-static 10.X.X.0 255.255.X.0 172.30.X.24
#
firewall zone trust
 add interface Eth-Trunk1.4
#
firewall zone untrust
 add interface Eth-Trunk1.24
#
ip address-set LingJie_Connect type object
 undo address all
 address 0 10.192.6.59 mask 32
 address 1 10.192.6.62 mask 32
 address 2 10.192.6.67 mask 32
 address 3 10.192.6.81 mask 32
 address 4 10.192.6.115 mask 32
 address 5 10.192.123.8 mask 32
#
ip address-set Nginx type object
 undo address all
 #address 0 10.x.x.x mask 32
 #address 1 10.x.x.x mask 32
 #address 2 10.x.x.x mask 32
#
ip address-set JumpServer type object
 undo address all
 address 0 10.192.0.22 mask 32
 address 1 10.192.1.74 mask 32
 address 2 10.192.1.200 mask 32
 address 3 10.192.1.218 mask 32
 address 4 10.193.134.196 mask 32
 address 5 10.193.134.135 mask 32
#
ip address-set BasicServer type group
 address 0 address-set LingJie_Connect
 address 1 address-set Nginx
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name jumpserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set JumpServer
  service telnet ssh rdp-tcp rdp-udp
  policy logging
  session logging
  action permit
  quit
 rule name basicserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set BasicServer
  policy logging
  session logging
  action permit
  quit
 rule name trust_to_any
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move jumpserver_permit after icmp
rule move basicserver_permit after jumpserver_permit
rule move trust_to_any after basicserver_permit
#
quit
quit
switch vsys OA
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.113
ip route-static 10.X.X.0 255.255.X.0 172.30.X.33
#
firewall zone trust
 add interface Eth-Trunk1.5
#
firewall zone untrust
 add interface Eth-Trunk1.25
#
ip address-set LingJie_Connect type object
 undo address all
 address 0 10.192.6.59 mask 32
 address 1 10.192.6.62 mask 32
 address 2 10.192.6.67 mask 32
 address 3 10.192.6.81 mask 32
 address 4 10.192.6.115 mask 32
 address 5 10.192.123.8 mask 32
#
ip address-set BasicServer type group
 address 0 address-set LingJie_Connect
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name basicserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set BasicServer
  policy logging
  session logging
  action permit
  quit
 rule name trust_to_any
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move basicserver_permit after icmp
rule move trust_to_any after basicserver_permit
#
quit
quit
switch vsys PD
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.121
ip route-static 10.X.X.0 255.255.X.0 172.30.X.41
#
firewall zone trust
 add interface Eth-Trunk1.6
#
firewall zone untrust
 add interface Eth-Trunk1.26
#
ip address-set LingJie_Connect type object
 undo address all
 address 0 10.192.6.59 mask 32
 address 1 10.192.6.62 mask 32
 address 2 10.192.6.67 mask 32
 address 3 10.192.6.81 mask 32
 address 4 10.192.6.115 mask 32
 address 5 10.192.123.8 mask 32
#
ip address-set Nginx type object
 undo address all
 #address 0 10.x.x.x mask 32
 #address 1 10.x.x.x mask 32
 #address 2 10.x.x.x mask 32
#
ip address-set Zhunru_Server type object
 undo address all
 #address 0 10.x.x.x mask 32
#
ip address-set JumpServer type object
 undo address all
 address 0 10.192.0.22 mask 32
 address 1 10.192.1.74 mask 32
 address 2 10.192.1.200 mask 32
 address 3 10.192.1.218 mask 32
 address 4 10.193.134.196 mask 32
 address 5 10.193.134.135 mask 32
#
ip address-set BasicServer type group
 address 0 address-set LingJie_Connect
 address 1 address-set Nginx
 address 2 address-set Zhunru_Server
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name jumpserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set JumpServer
  service telnet ssh rdp-tcp rdp-udp
  policy logging
  session logging
  action permit
  quit
 rule name basicserver_permit
  source-zone untrust
  destination-zone trust
  source-address address-set BasicServer
  policy logging
  session logging
  action permit
  quit
 rule name trust_to_any
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move jumpserver_permit after icmp
rule move basicserver_permit after jumpserver_permit
rule move trust_to_any after basicserver_permit
#
quit
quit
switch vsys JK
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.129
ip route-static 10.X.X.0 255.255.X.0 172.30.X.49
firewall zone trust
 add interface Eth-Trunk1.7
#
firewall zone untrust
 add interface Eth-Trunk1.27
#
ip address-set kqj_server type object
 address 0 10.192.7.73 mask 32
#
ip address-set visitor_device type object
 #address 0 10.X.X.X mask 32
 #address 1 10.X.X.X mask 32
#
ip address-set visitor_server type object
 address 0 10.195.147.156 mask 32
#
ip address-set kqj&visitor_server type group
 address 0 address-set kqj_server
 address 1 address-set visitor_server
#
domain-set name visitor_plat
 add domain entranceguard.leapmotor.com
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
rule name server_to_jk
  source-zone untrust
  destination-zone trust
  source-address address-set kqj_server
  source-address address-set visitor_server
  service http
  service https
  service protocol tcp source-port 0 to 65535 destination-port 37777
  policy logging
  session logging
  traffic logging enable
  action permit
  quit
rule name fkdevice_to_fkplat
  source-zone trust
  destination-zone untrust
  source-address address-set visitor_device
  destination-address domain-set visitor_plat
  service https
  policy logging
  session logging
  traffic logging enable
  action permit
  quit
rule move icmp top
rule move server_to_jk after icmp
rule move fkdevice_to_fkplat after server_to_jk
#
quit
quit
switch vsys Guest
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.137
ip route-static 10.X.X.0 255.255.X.0 172.30.X.57
#
firewall zone trust
 add interface Eth-Trunk1.8
#
firewall zone untrust
 add interface Eth-Trunk1.28
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
  quit
 rule name deny_internal
  source-zone trust
  destination-zone untrust
  destination-address 10.0.0.0 mask 255.0.0.0
  policy logging
  session logging
  action deny
  quit
 rule name trust_to_internet
  source-zone trust
  destination-zone untrust
  policy logging
  session logging
  action permit
  quit
rule move icmp top
rule move deny_internal after icmp
rule move trust_to_internet after deny_internal
#
quit
quit
switch vsys OTA
sys
#
ip route-static 0.0.0.0 0.0.0.0 172.30.X.145
ip route-static 10.X.X.0 255.255.X.0 172.30.X.65
#
firewall zone trust
 add interface Eth-Trunk1.9
#
firewall zone untrust
 add interface Eth-Trunk1.29
#
security-policy
 rule name icmp
  service icmp
  policy logging
  session logging
  action permit
quit
rule move icmp top
#
quit
quit
undo mmi-mode enable
